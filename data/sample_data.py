"""
Sample data for demo purposes
"""

import streamlit as st
from datetime import datetime, timedelta

def reset_demo_data():
    """Clear all demo data and re-initialize."""
    keys = [
        'customers', 'rfqs', 'estimations', 'projects', 'test_plans',
        'test_executions', 'test_results', 'samples', 'trfs', 'documents',
        'audits', 'ncrs', 'certifications', 'initialized'
    ]
    for k in keys:
        if k in st.session_state:
            del st.session_state[k]
    initialize_data()

def initialize_data():
    """Initialize sample data in session state"""
    
    # Customers
    if 'customers' not in st.session_state or len(st.session_state.customers) == 0:
        st.session_state.customers = [
            {
                'id': 1,
                'company_name': 'TechCorp Industries',
                'email': 'contact@techcorp.com',
                'contact_person': 'John Smith',
                'phone': '+91 9876543210',
                'address': '123 Tech Park, Bangalore, Karnataka 560001',
                'gst_number': '29AABCT1234F1Z5',
                'status': 'active',
                'created_at': '2024-01-10 10:00:00',
            },
            {
                'id': 2,
                'company_name': 'ElectroSystems Ltd',
                'email': 'info@electrosystems.com',
                'contact_person': 'Sarah Johnson',
                'phone': '+91 9876543211',
                'address': '456 Industrial Area, Mumbai, Maharashtra 400001',
                'gst_number': '27AABCE2345G2Z6',
                'status': 'active',
                'created_at': '2024-01-12 11:30:00',
            },
            {
                'id': 3,
                'company_name': 'Digital Solutions Inc',
                'email': 'hello@digitalsolutions.com',
                'contact_person': 'Mike Chen',
                'phone': '+91 9876543212',
                'address': '789 Business Hub, Pune, Maharashtra 411001',
                'gst_number': '27AABCD3456H3Z7',
                'status': 'active',
                'created_at': '2024-01-15 14:00:00',
            },
            {
                'id': 4,
                'company_name': 'Innovation Labs',
                'email': 'contact@innovationlabs.com',
                'contact_person': 'Emily Davis',
                'phone': '+91 9876543213',
                'address': '321 Tech City, Hyderabad, Telangana 500001',
                'gst_number': '36AABCI4567I4Z8',
                'status': 'active',
                'created_at': '2024-01-18 09:00:00',
            },
        ]
    
    # RFQs
    if 'rfqs' not in st.session_state or len(st.session_state.rfqs) == 0:
        st.session_state.rfqs = [
            {
                'id': 1,
                'customer_id': 1,
                'customer_name': 'TechCorp Industries',
                'product': 'Smart Router X200',
                'description': 'EMC testing for smart router with WiFi 6 capability',
                'received_date': '2024-01-15',
                'status': 'pending',
                'notes': 'Urgent requirement, customer needs report by end of month',
            },
            {
                'id': 2,
                'customer_id': 2,
                'customer_name': 'ElectroSystems Ltd',
                'product': 'RF Compliance Module',
                'description': 'Complete RF testing and certification',
                'received_date': '2024-01-20',
                'status': 'approved',
                'notes': 'Standard testing package requested',
            },
            {
                'id': 3,
                'customer_id': 3,
                'customer_name': 'Digital Solutions Inc',
                'product': 'IoT Sensor Hub',
                'description': 'Safety and environmental testing',
                'received_date': '2024-01-22',
                'status': 'pending',
                'notes': 'Multiple units for testing',
            },
        ]
    
    # Estimations
    if 'estimations' not in st.session_state or len(st.session_state.estimations) == 0:
        st.session_state.estimations = [
            {
                'id': 1,
                'rfq_id': 1,
                'customer_id': 1,
                'customer_name': 'TechCorp Industries',
                'product': 'Smart Router X200',
                'test_types': ['Precompliance (3 tests)', 'Compliance (1 test)'],
                'total_cost': 40000.0,
                'status': 'sent',
                'created_at': '2024-01-16',
                'valid_until': '2024-02-15',
                'notes': 'Includes expedited processing',
                'precompliance': {
                    'num_tests': 3,
                    'cycle_cost': 15000.0,
                    'num_cycles': 1,
                    'total_cost': 15000.0,
                },
                'compliance': {
                    'num_tests': 1,
                    'cycle_cost': 25000.0,
                    'num_cycles': 1,
                    'total_cost': 25000.0,
                },
            },
            {
                'id': 2,
                'rfq_id': 2,
                'customer_id': 2,
                'customer_name': 'ElectroSystems Ltd',
                'product': 'RF Compliance Module',
                'test_types': ['Precompliance (4 tests)', 'Compliance (1 test)'],
                'total_cost': 85000.0,
                'status': 'approved',
                'created_at': '2024-01-21',
                'valid_until': '2024-02-20',
                'notes': 'Standard package - multiple compliance cycles may be required',
                'precompliance': {
                    'num_tests': 4,
                    'cycle_cost': 15000.0,
                    'num_cycles': 2,
                    'total_cost': 30000.0,
                },
                'compliance': {
                    'num_tests': 1,
                    'cycle_cost': 27500.0,
                    'num_cycles': 2,
                    'total_cost': 55000.0,
                },
            },
            {
                'id': 3,
                'rfq_id': 3,
                'customer_id': 3,
                'customer_name': 'Digital Solutions Inc',
                'product': 'IoT Sensor Hub',
                'test_types': ['Precompliance (3 tests)', 'Compliance (1 test)'],
                'total_cost': 65000.0,
                'status': 'draft',
                'created_at': '2024-01-23',
                'valid_until': '2024-02-22',
                'notes': 'Awaiting customer confirmation on quantity. Compliance may require additional cycles if product fails.',
                'precompliance': {
                    'num_tests': 3,
                    'cycle_cost': 14000.0,
                    'num_cycles': 1,
                    'total_cost': 14000.0,
                },
                'compliance': {
                    'num_tests': 1,
                    'cycle_cost': 25500.0,
                    'num_cycles': 2,
                    'total_cost': 51000.0,
                },
            },
        ]
    
    # Projects
    if 'projects' not in st.session_state or len(st.session_state.projects) == 0:
        st.session_state.projects = [
            {
                'id': 1,
                'code': 'PROJ-2024-001',
                'name': 'EMC Testing - Smart Router X200',
                'client_id': 1,
                'client_name': 'TechCorp Industries',
                'description': 'Complete EMC testing suite for smart router',
                'status': 'active',
                'start_date': '2024-01-20',
                'end_date': '2024-02-10',
                'estimated_cost': 85000.0,
                'actual_cost': 0.0,
                'created_at': '2024-01-18 10:00:00',
            },
            {
                'id': 2,
                'code': 'PROJ-2024-002',
                'name': 'RF Compliance - RF Module',
                'client_id': 2,
                'client_name': 'ElectroSystems Ltd',
                'description': 'RF testing and certification',
                'status': 'active',
                'start_date': '2024-01-22',
                'end_date': '2024-02-15',
                'estimated_cost': 95000.0,
                'actual_cost': 0.0,
                'created_at': '2024-01-20 11:00:00',
            },
            {
                'id': 3,
                'code': 'PROJ-2024-003',
                'name': 'Safety Testing - IoT Hub',
                'client_id': 3,
                'client_name': 'Digital Solutions Inc',
                'description': 'Safety and environmental testing',
                'status': 'pending',
                'start_date': '2024-02-01',
                'end_date': '2024-02-20',
                'estimated_cost': 72000.0,
                'actual_cost': 0.0,
                'created_at': '2024-01-22 14:00:00',
            },
            {
                'id': 4,
                'code': 'PROJ-2023-045',
                'name': 'Certification - Power Adapter',
                'client_id': 4,
                'client_name': 'Innovation Labs',
                'description': 'Complete certification testing',
                'status': 'completed',
                'start_date': '2023-12-01',
                'end_date': '2023-12-28',
                'estimated_cost': 55000.0,
                'actual_cost': 53000.0,
                'created_at': '2023-11-28 09:00:00',
            },
            {
                'id': 5,
                'code': 'PROJ-2024-004',
                'name': 'EMC Testing - LED Driver',
                'client_id': 1,
                'client_name': 'TechCorp Industries',
                'description': 'EMC compliance testing for LED driver',
                'status': 'active',
                'start_date': '2024-01-25',
                'end_date': '2024-02-18',
                'estimated_cost': 48000.0,
                'actual_cost': 0.0,
                'created_at': '2024-01-23 15:30:00',
            },
        ]
    
    # Test Plans
    if 'test_plans' not in st.session_state or len(st.session_state.test_plans) == 0:
        st.session_state.test_plans = [
            {
                'id': 1,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'name': 'EMC Compliance Test Plan',
                'description': 'Full EMC testing suite for electromagnetic compatibility',
                'test_type': 'EMC',
                'status': 'Approved',
                'assigned_engineer_id': 1,
                'assigned_engineer_name': 'John Doe',
                'planned_start_date': '2024-01-20',
                'planned_end_date': '2024-02-05',
                'actual_start_date': '2024-01-20',
                'actual_end_date': None,
                'created_at': '2024-01-18 10:30:00',
            },
            {
                'id': 2,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'name': 'RF Emission Test Plan',
                'description': 'RF emission testing and compliance verification',
                'test_type': 'RF',
                'status': 'InProgress',
                'assigned_engineer_id': 2,
                'assigned_engineer_name': 'Jane Smith',
                'planned_start_date': '2024-01-22',
                'planned_end_date': '2024-02-08',
                'actual_start_date': '2024-01-22',
                'actual_end_date': None,
                'created_at': '2024-01-18 11:00:00',
            },
            {
                'id': 3,
                'project_id': 2,
                'project_name': 'RF Compliance - RF Module',
                'name': 'RF Compliance Test',
                'description': 'Complete RF compliance testing',
                'test_type': 'RF',
                'status': 'InProgress',
                'assigned_engineer_id': 2,
                'assigned_engineer_name': 'Jane Smith',
                'planned_start_date': '2024-01-22',
                'planned_end_date': '2024-02-10',
                'actual_start_date': '2024-01-22',
                'actual_end_date': None,
                'created_at': '2024-01-20 11:30:00',
            },
            {
                'id': 4,
                'project_id': 2,
                'project_name': 'RF Compliance - RF Module',
                'name': 'Safety Certification Test',
                'description': 'Safety testing and certification process',
                'test_type': 'Safety',
                'status': 'Draft',
                'assigned_engineer_id': 3,
                'assigned_engineer_name': 'Mike Johnson',
                'planned_start_date': '2024-02-01',
                'planned_end_date': '2024-02-12',
                'actual_start_date': None,
                'actual_end_date': None,
                'created_at': '2024-01-20 12:00:00',
            },
            {
                'id': 5,
                'project_id': 3,
                'project_name': 'Safety Testing - IoT Hub',
                'name': 'Environmental Stress Test',
                'description': 'Environmental stress testing under various conditions',
                'test_type': 'Environmental',
                'status': 'Draft',
                'assigned_engineer_id': 4,
                'assigned_engineer_name': 'Sarah Williams',
                'planned_start_date': '2024-02-01',
                'planned_end_date': '2024-02-15',
                'actual_start_date': None,
                'actual_end_date': None,
                'created_at': '2024-01-22 14:30:00',
            },
            {
                'id': 6,
                'project_id': 4,
                'project_name': 'Certification - Power Adapter',
                'name': 'Power Adapter Certification',
                'description': 'Complete certification testing',
                'test_type': 'Safety',
                'status': 'Completed',
                'assigned_engineer_id': 3,
                'assigned_engineer_name': 'Mike Johnson',
                'planned_start_date': '2023-12-01',
                'planned_end_date': '2023-12-20',
                'actual_start_date': '2023-12-01',
                'actual_end_date': '2023-12-18',
                'created_at': '2023-11-28 09:30:00',
            },
            {
                'id': 7,
                'project_id': 5,
                'project_name': 'EMC Testing - LED Driver',
                'name': 'LED Driver EMC Test',
                'description': 'EMC compliance testing',
                'test_type': 'EMC',
                'status': 'InProgress',
                'assigned_engineer_id': 1,
                'assigned_engineer_name': 'John Doe',
                'planned_start_date': '2024-01-25',
                'planned_end_date': '2024-02-12',
                'actual_start_date': '2024-01-25',
                'actual_end_date': None,
                'created_at': '2024-01-23 16:00:00',
            },
            {
                'id': 8,
                'project_id': 5,
                'project_name': 'EMC Testing - LED Driver',
                'name': 'Thermal Analysis',
                'description': 'Thermal testing and analysis',
                'test_type': 'Environmental',
                'status': 'Draft',
                'assigned_engineer_id': 4,
                'assigned_engineer_name': 'Sarah Williams',
                'planned_start_date': '2024-02-05',
                'planned_end_date': '2024-02-15',
                'actual_start_date': None,
                'actual_end_date': None,
                'created_at': '2024-01-23 16:30:00',
            },
        ]
    
    # Test Executions
    if 'test_executions' not in st.session_state or len(st.session_state.test_executions) == 0:
        st.session_state.test_executions = [
            {
                'id': 1,
                'test_plan_id': 1,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'test_name': 'Radiated Emissions - Chamber 1',
                'status': 'Completed',
                'started_at': '2024-01-24 09:00:00',
                'ended_at': '2024-01-24 10:00:00',
                'result': 'Pass',
            },
            {
                'id': 2,
                'test_plan_id': 2,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'test_name': 'RF Output Power',
                'status': 'Completed',
                'started_at': '2024-01-25 14:00:00',
                'ended_at': '2024-01-25 15:30:00',
                'result': 'Pass',
            },
            {
                'id': 3,
                'test_plan_id': 3,
                'project_id': 2,
                'project_name': 'RF Compliance - RF Module',
                'test_name': 'Conducted Emissions',
                'status': 'Completed',
                'started_at': '2024-01-27 10:00:00',
                'ended_at': '2024-01-27 11:15:00',
                'result': 'Fail',
            },
        ]
    
    # Test Results
    if 'test_results' not in st.session_state or len(st.session_state.test_results) == 0:
        st.session_state.test_results = [
            {
                'id': 1,
                'test_name': 'Radiated Emissions - 30MHz to 1GHz',
                'test_type': 'EMC',
                'test_plan_id': 1,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'pass_fail': 'Pass',
                'created_at': '2024-01-24 10:15:00',
            },
            {
                'id': 2,
                'test_name': 'RF Output Power Verification',
                'test_type': 'RF',
                'test_plan_id': 2,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'pass_fail': 'Pass',
                'created_at': '2024-01-25 15:45:00',
            },
            {
                'id': 3,
                'test_name': 'Conducted Emissions - Mains',
                'test_type': 'EMC',
                'test_plan_id': 3,
                'project_id': 2,
                'project_name': 'RF Compliance - RF Module',
                'pass_fail': 'Fail',
                'created_at': '2024-01-27 11:05:00',
            },
            {
                'id': 4,
                'test_name': 'Thermal Cycling - High Temp',
                'test_type': 'Environmental',
                'test_plan_id': 5,
                'project_id': 3,
                'project_name': 'Safety Testing - IoT Hub',
                'pass_fail': 'Pass',
                'created_at': '2024-02-03 09:30:00',
            },
        ]
    
    # Samples
    if 'samples' not in st.session_state or len(st.session_state.samples) == 0:
        st.session_state.samples = [
            {
                'id': 1,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'sample_number': 'SMP-1042',
                'name': 'Router Main Unit',
                'sample_type': 'Product',
                'quantity': 3,
                'status': 'in_testing',
                'received_date': '2024-01-19',
                'description': 'Three production units with latest firmware build.',
            },
            {
                'id': 2,
                'project_id': 2,
                'project_name': 'RF Compliance - RF Module',
                'sample_number': 'SMP-2088',
                'name': 'RF Module EVT boards',
                'sample_type': 'Component',
                'quantity': 5,
                'status': 'tested',
                'received_date': '2024-01-21',
                'description': 'EVT boards for conducted/radiated RF testing.',
            },
            {
                'id': 3,
                'project_id': 3,
                'project_name': 'Safety Testing - IoT Hub',
                'sample_number': 'SMP-3125',
                'name': 'IoT Hub enclosure set',
                'sample_type': 'Material',
                'quantity': 2,
                'status': 'received',
                'received_date': '2024-01-31',
                'description': 'Enclosure material samples for flammability review.',
            },
        ]
    
    # TRFs
    if 'trfs' not in st.session_state or len(st.session_state.trfs) == 0:
        st.session_state.trfs = [
            {
                'id': 1,
                'project_id': 1,
                'project_name': 'EMC Testing - Smart Router X200',
                'trf_number': 'TRF-2024-1101',
                'requested_tests': ['EMC Testing', 'RF Testing'],
                'requirements': 'CISPR 32 Class B, EN 301 489',
                'notes': 'Prioritize radiated emissions chambers.',
                'status': 'approved',
                'priority': 'high',
                'created_at': '2024-01-18 12:00:00',
            },
            {
                'id': 2,
                'project_id': 2,
                'project_name': 'RF Compliance - RF Module',
                'trf_number': 'TRF-2024-1102',
                'requested_tests': ['RF Testing', 'Safety Testing'],
                'requirements': 'FCC Part 15C, EN 62368-1 clauses 4/5',
                'notes': 'Include spurious emissions up to 6 GHz.',
                'status': 'submitted',
                'priority': 'normal',
                'created_at': '2024-01-20 09:30:00',
            },
            {
                'id': 3,
                'project_id': 5,
                'project_name': 'EMC Testing - LED Driver',
                'trf_number': 'TRF-2024-1103',
                'requested_tests': ['EMC Testing', 'Environmental Testing'],
                'requirements': 'IEC 61000-4-2/-4/-5, thermal stress 70C/24h',
                'notes': 'Pre-compliance run before certification window.',
                'status': 'draft',
                'priority': 'urgent',
                'created_at': '2024-01-24 16:45:00',
            },
        ]
    
    # Documents
    if 'documents' not in st.session_state or len(st.session_state.documents) == 0:
        st.session_state.documents = [
            {
                'id': 1,
                'name': 'EMC Test Report - Router X200',
                'category': 'Test Report',
                'version': 'v1.0',
                'status': 'approved',
                'description': 'Full EMC report covering radiated and conducted emissions.',
                'filename': 'EMC_Report_RouterX200.pdf',
                'uploaded_at': '2024-02-06 10:10:00',
            },
            {
                'id': 2,
                'name': 'Safety Checklist - RF Module',
                'category': 'Specification',
                'version': 'v0.9',
                'status': 'draft',
                'description': 'Safety compliance checklist for EN 62368-1.',
                'filename': 'RFModule_Safety_Checklist.xlsx',
                'uploaded_at': '2024-01-26 14:20:00',
            },
            {
                'id': 3,
                'name': 'Calibration Certificate - Chamber 2',
                'category': 'Certificate',
                'version': '2024',
                'status': 'approved',
                'description': 'Annual calibration certificate for semi-anechoic chamber.',
                'filename': 'CalCert_Chamber2_2024.pdf',
                'uploaded_at': '2024-01-15 09:00:00',
            },
        ]
    
    # Audits
    if 'audits' not in st.session_state or len(st.session_state.audits) == 0:
        st.session_state.audits = [
            {
                'id': 1,
                'name': 'Internal QMS Audit - Q1',
                'audit_type': 'Internal Audit',
                'auditor': 'Priya Nair',
                'scheduled_date': '2024-02-10',
                'status': 'scheduled',
                'department': 'Quality',
                'scope': 'QMS process adherence and document control',
                'findings': '',
                'created_at': '2024-01-20 10:00:00',
            },
            {
                'id': 2,
                'name': 'Safety Compliance Audit',
                'audit_type': 'Compliance Audit',
                'auditor': 'Arun Mehta',
                'scheduled_date': '2024-02-05',
                'status': 'in_progress',
                'department': 'Lab Operations',
                'scope': 'Safety controls, PPE usage, equipment grounding checks',
                'findings': 'Minor PPE non-compliance in chamber area.',
                'created_at': '2024-01-18 11:00:00',
            },
            {
                'id': 3,
                'name': 'External Accreditation Surveillance',
                'audit_type': 'Surveillance Audit',
                'auditor': 'Accreditation Body',
                'scheduled_date': '2024-03-02',
                'status': 'scheduled',
                'department': 'All',
                'scope': 'ISO/IEC 17025 surveillance for EMC & RF scopes',
                'findings': '',
                'created_at': '2024-01-25 09:15:00',
            },
        ]
    
    # NCRs
    if 'ncrs' not in st.session_state or len(st.session_state.ncrs) == 0:
        st.session_state.ncrs = [
            {
                'id': 1,
                'title': 'Cable labeling missing in Chamber 1',
                'description': 'RF coax cables were not labeled per SOP during setup.',
                'severity': 'minor',
                'category': 'Process',
                'status': 'action_taken',
                'reported_by': 'Alex Kumar',
                'detected_date': '2024-01-19',
                'root_cause': 'New technician not trained on labeling SOP.',
                'corrective_action': 'Retrained staff; added checklist step before test start.',
                'created_at': '2024-01-19 17:30:00',
            },
            {
                'id': 2,
                'title': 'Chamber ambient exceeded spec',
                'description': 'Ambient temperature reached 27.5C during emission test.',
                'severity': 'major',
                'category': 'Equipment',
                'status': 'investigating',
                'reported_by': 'Jane Smith',
                'detected_date': '2024-01-24',
                'root_cause': 'HVAC filter clog suspected.',
                'corrective_action': 'Pending root cause confirmation; schedule maintenance.',
                'created_at': '2024-01-24 12:10:00',
            },
            {
                'id': 3,
                'title': 'Incorrect LISN calibration file used',
                'description': 'Calibration file for LISN was outdated by 2 months.',
                'severity': 'critical',
                'category': 'Quality',
                'status': 'open',
                'reported_by': 'Mike Johnson',
                'detected_date': '2024-01-27',
                'root_cause': 'Calibration tracker not updated after last service.',
                'corrective_action': 'Re-run affected tests; update tracker; lock file versions.',
                'created_at': '2024-01-27 08:50:00',
            },
        ]
    
    # Certifications
    if 'certifications' not in st.session_state or len(st.session_state.certifications) == 0:
        st.session_state.certifications = [
            {
                'id': 1,
                'name': 'ISO/IEC 17025 - EMC',
                'cert_type': 'Testing Accreditation',
                'cert_number': 'LAB-17025-EMC-2023',
                'issued_by': 'NABL',
                'issue_date': '2023-06-15',
                'expiry_date': '2026-06-14',
                'status': 'active',
                'scope': 'EMC testing for IT and multimedia equipment',
                'notes': 'Surveillance audit due Mar 2024',
                'created_at': '2023-06-15 10:00:00',
            },
            {
                'id': 2,
                'name': 'ISO 9001:2015',
                'cert_type': 'Quality Management',
                'cert_number': 'QMS-9001-4587',
                'issued_by': 'TUV',
                'issue_date': '2022-11-01',
                'expiry_date': '2025-10-31',
                'status': 'active',
                'scope': 'Design and execution of product compliance testing',
                'notes': 'Next internal audit Q1 2024',
                'created_at': '2022-11-01 09:00:00',
            },
            {
                'id': 3,
                'name': 'Electrical Safety License',
                'cert_type': 'Safety Management',
                'cert_number': 'SAFE-EL-7751',
                'issued_by': 'Local Authority',
                'issue_date': '2023-01-10',
                'expiry_date': '2024-12-31',
                'status': 'pending_renewal',
                'scope': 'Operation of high-voltage safety test equipment',
                'notes': 'Renewal application in progress',
                'created_at': '2023-01-10 11:00:00',
            },
        ]

    st.session_state.initialized = True

